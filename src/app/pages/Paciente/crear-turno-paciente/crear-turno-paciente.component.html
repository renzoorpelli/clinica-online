<div class="container">
  <form [formGroup]="turnoPacienteForm" (ngSubmit)="onSubmit()">
    <div class="form-group mb-3">
      <label for="especialista" class="lead mb-3">Especialista</label>
      <select id="especialista" (change)="onEspecialistaChange()" class="form-control" [(ngModel)]="docRefSpecialistSelected" [ngModelOptions]="{standalone:true}">
        <option *ngFor="let item of specialistList" [value]="item.docRefEspecialista">{{item.nombre}}-{{item.apellido}}</option>
      </select>
    </div>
    <ng-container *ngIf="selectedSpecialist && selectedSpecialist.especialidades">
      <label class="lead">El especialista atiende las siguientes especialidades en los días:</label>
      <div class="row mt-3">
        <div class="col-12 col-sm-6 col-md-4" *ngFor="let item of selectedSpecialist.especialidades">
          <div class="card mb-3">
            <div class="card-header">ESPECIALIDAD: {{item.nombre}}</div>
            <div class="card-body">
              <p>Día: {{item.agenda.dia}}</p>
              <p>Desde: {{item.agenda.desde}}</p>
              <p>Hasta: {{item.agenda.hasta}}</p>
            </div>
          </div>
        </div>
      </div>
    </ng-container>
    <ng-container *ngIf="this.selectedSpecialist && this.selectedSpecialist.especialidad">
      <div class="form-group mt-3">
        <label for="especialidad" class="lead mb-3">Selecciona la especialidad para saber los turnos disponibles:</label>
        <select id="especialidad"  (change)="onEspecialidadChange()" class="form-control" [(ngModel)]="specialitySelected" [ngModelOptions]="{standalone:true}">
          <option *ngFor="let item of selectedSpecialist.especialidad" [value]="item">{{item}}</option>
        </select>
      </div>
    </ng-container>
    <ng-container *ngIf="this.selectedSpecialist && this.selectedSpecialist.turnos && this.specialitySelected;else error">
      <div class="form-group mt-3">
        <label for="turno" class="lead mb-3">Turno Disponible especialidad</label>
        <select id="especialidad" class="form-control" (change)="onTurnoChange()" [(ngModel)]="selectedShiftDocRef" [ngModelOptions]="{standalone:true}">
          <option *ngFor="let item of selectedSpecialist.turnos | filterShiftBySpeciality: specialitySelected" [value]="item.idTurnoDocRef">ESPECIALIDAD: {{item.especialidad}} - {{item.fechaTurno}}</option>
        </select>
      </div>
      <div class="form-group mt-3">
        <label for="turno" class="lead mb-3">Seleccione el tipo de turno</label>
        <select id="especialidad" class="form-control" [(ngModel)]="this.selectedTypeOfShift" [ngModelOptions]="{standalone:true}">
          <option *ngFor="let item of TYPE_SHIFT" [value]="item">{{item}}</option>
        </select>
        <div class="form-check mt-3">
          <input class="form-check-input" type="checkbox" id="checkTerminos" formControlName="aceptaTerminos">
          <label class="form-check-label" for="checkTerminos">
            Acepto que el turno queda pendiente de ser aceptado por el profesional.
          </label>
        </div>
      </div>
    </ng-container>
    <ng-template #error>
      <p class="lead text-danger">Lo lamento, no hay turnos cargados para esa especialidad</p>
    </ng-template>
    <div class="form-group mt-3">
      <button type="submit" [disabled]="!this.turnoPacienteForm.get('aceptaTerminos')?.value" class="btn btn-outline-secondary">Asignar Turno</button>
    </div>
  </form>
</div>
